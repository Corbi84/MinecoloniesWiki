---
import BuildingNameInternal from '@components/wiki/BuildingName.astro';
import { type MarkdocBuildingComponent } from '@utils/building';
import { getWikiPage, isWikiDataOfType } from '@utils/wiki';

interface Props extends MarkdocBuildingComponent {
  plural?: boolean;
}

const { frontmatter, name, plural = false } = Astro.props;

const buildingId = isWikiDataOfType(frontmatter, 'building') ? frontmatter.id : name;
const buildingPage = await getWikiPage('building', 'buildings/' + buildingId);
if (buildingPage === undefined) {
  throw Error(`Building id ${buildingId} does not exist.`);
}
---

<BuildingNameInternal
  building={buildingPage}
  plural={plural}
  link={frontmatter.type !== 'building' || frontmatter.id !== buildingPage.data.id}
/>
